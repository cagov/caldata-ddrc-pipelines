{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.5", "generated_at": "2025-08-22T00:08:31.461198Z", "invocation_id": "b53edb49-ba55-4d20-b367-8d4fae4820ee", "invocation_started_at": "2025-08-22T00:08:17.397413Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:28.959590Z", "completed_at": "2025-08-22T00:08:28.979241Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:28.979908Z", "completed_at": "2025-08-22T00:08:28.979928Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03412890434265137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.stg_malibu__fire_rebuild_points", "compiled": true, "compiled_code": "select\n    \"type\" as type,\n    \"lat\" as lat,\n    \"lng\" as lon,\n    \"projectNumber\" as project_number,\n    \"planningApproved\" as planning_approved,\n    _load_date,\n    _loaded_at as last_updated\nfrom RAW_DDRC_PRD.MALIBU_REBUILDS.FIRE_REBUILD_POINTS", "relation_name": "TRANSFORM_DDRC_PRD.malibu.stg_malibu__fire_rebuild_points", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:28.963785Z", "completed_at": "2025-08-22T00:08:28.980926Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:28.981541Z", "completed_at": "2025-08-22T00:08:28.981551Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03513050079345703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.stg_malibu__palisades_permits_issued_read", "compiled": true, "compiled_code": "select\n    \"PermitType\" as type,\n    \"PalisadesPermits\" as permits,\n    _load_date,\n    _loaded_at as last_updated\nfrom RAW_DDRC_PRD.MALIBU_REBUILDS.PALISADES_PERMITS_ISSUED_READ", "relation_name": "TRANSFORM_DDRC_PRD.malibu.stg_malibu__palisades_permits_issued_read", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:28.969282Z", "completed_at": "2025-08-22T00:08:28.989618Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:28.994112Z", "completed_at": "2025-08-22T00:08:28.994125Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.04661250114440918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.stg_pasadena__eaton_fire_rebuild_permits", "compiled": true, "compiled_code": "select\n    ID,\n    PMPERMITID as PM_PERMIT_ID,\n    PERMIT_NUMBER,\n    PARCEL_NUMBER,\n    ADDRESS,\n    CITY,\n    STATE,\n    ZIPCODE,\n    PERMIT_STATUS,\n    WORK_CLASS,\n    PERMIT_TYPE,\n    DESCRIPTION,\n    COUNCIL_DISTRICT,\n    _LOAD_DATE,\n    to_timestamp_tz(_LAST_EDIT_DATE, 3) as LAST_UPDATED\nfrom RAW_DDRC_PRD.PASADENA_AGOL.EATON_FIRE_REBUILD_PERMITS", "relation_name": "TRANSFORM_DDRC_PRD.pasadena.stg_pasadena__eaton_fire_rebuild_permits", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:28.966211Z", "completed_at": "2025-08-22T00:08:28.990130Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:28.995450Z", "completed_at": "2025-08-22T00:08:28.995458Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.048484086990356445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.stg_usace__parcel_debris_removal", "compiled": true, "compiled_code": "with pdr as (\n\n    select\n        \"ma\" as ma,\n        \"apn\" as assessor_parcel_number,\n        \"apn_coincident_list\" as apn_conincident_list,\n        \"address\" as address,\n        \"epa_status\" as epa_status,\n        \"roe_status\" as roe_status,\n        to_timestamp_tz(\"roe_received\"::int, 3) as roe_received,\n        to_timestamp_tz(\"roe_approved\"::int, 3) as roe_approved,\n        to_timestamp_tz(\"roe_submitted\"::int, 3) as roe_submitted,\n        to_timestamp_tz(\"roe_withdrawn\"::int, 3) as roe_withdrawn,\n        \"roe_details\" as roe_details,\n        \"hsa_status\" as hsa_status,\n        to_timestamp_tz(\"hsa_report_received\"::int, 3) as hsa_report_received,\n        to_timestamp_tz(\"hsa_report_approved\"::int, 3) as hsa_report_approved,\n        \"pcr_status\" as pcr_status,\n        to_timestamp_tz(\"pcr_received\"::int, 3) as pcr_received,\n        to_timestamp_tz(\"pcr_approved\"::int, 3) as pcr_approved,\n        to_timestamp_tz(\"pcr_delivery\"::int, 3) as pcr_delivery,\n        to_timestamp_tz(\"fso_pkg_returned\"::int, 3) as fso_pkg_returned,\n        to_timestamp_tz(\"fso_pkg_approved\"::int, 3) as fso_pkg_approved,\n        objectid as object_id,\n        gdb_to_date,\n        gdb_from_date,\n        \"geometry\" as geometry,\n        \"event_sub_name\" as event_sub_name,\n        _load_date,\n        to_timestamp_tz(_loaded_at) as last_updated\n\n    from RAW_DDRC_PRD.USACE_AGOL_DEBRIS.PARCEL_DEBRIS_REMOVAL\n\n)\n\nselect * from pdr", "relation_name": "TRANSFORM_DDRC_PRD.usace.stg_usace__parcel_debris_removal", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:28.975116Z", "completed_at": "2025-08-22T00:08:28.993416Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:28.996862Z", "completed_at": "2025-08-22T00:08:28.996870Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.048818111419677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.stg_epa__public_status_assessment", "compiled": true, "compiled_code": "with psa as (\n\n    select\n\n        apn as assessor_parcel_number,\n        \"Address\" as address,\n        \"AssessmentDate\" as assessment_date,\n        \"FireName\" as fire_name,\n        \"GlobalID\" as global_id,\n        \"LandUse\" as land_use,\n        objectid as object_id,\n        \"PublicStatus\" as public_status,\n        \"Shape__Area\" as shape_area,\n        \"Shape__Length\" as shape_length,\n        TO_TIMESTAMP_TZ(_last_edit_date, 3) as last_updated,\n        _load_date as load_date,\n        \"geometry\" as geometry\n\n    from RAW_DDRC_PRD.EPA_AGOL_ASSESSMENT.PUBLIC_STATUS_ASSESSMENT\n\n)\n\nselect * from psa", "relation_name": "TRANSFORM_DDRC_PRD.epa.stg_epa__public_status_assessment", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:28.951617Z", "completed_at": "2025-08-22T00:08:28.994914Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:28.998282Z", "completed_at": "2025-08-22T00:08:28.998289Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05303168296813965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.stg_airtable__metrics", "compiled": true, "compiled_code": "with air as (\n\n    select\n        metrics.id,\n        metrics._fivetran_synced,\n        metrics.datetime_offset_number,\n        to_timestamp_tz(metrics.date_created) as date_created,\n        metrics.as_of_label,\n        metrics.datetime_offset_variable,\n        to_timestamp_tz(metrics.date_metric_modified) as date_metric_modified,\n        metrics.metric,\n        a.value::varchar as metric_type,\n        b.value::varchar as as_of_time,\n        c.value::varchar as metric_name,\n        d.value::varchar as metric_unit_label,\n        e.value::varchar as metric_title_for_interface,\n        f.value::varchar as metric_machine_name,\n        g.value::varchar as topic,\n        h.value::varchar as update_frequency\n\n    from RAW_DDRC_PRD.ODI_AIRTABLE_LA_RECOVERY_METRICS_APPL6HFEE8UDLUC3G.METRICS as metrics,\n        lateral flatten(metrics.metric_type_from_metric_definition_) as a,\n        lateral flatten(metrics.as_of_time_from_metric_definition_) as b,\n        lateral flatten(metrics.metric_name_from_metric_definition_) as c,\n        lateral flatten(metrics.metric_unit_label_from_metric_definition_) as d,\n        lateral flatten(metrics.metric_title_for_interface) as e,\n        lateral flatten(metrics.metric_machine_name_from_metric_definition_) as f,\n        lateral flatten(metrics.topic_from_metric_definition_) as g,\n        lateral flatten(metrics.update_frequency_from_metric_definition_) as h\n\n)\n\nselect * from air", "relation_name": "TRANSFORM_DDRC_PRD.airtable.stg_airtable__metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:28.984010Z", "completed_at": "2025-08-22T00:08:28.996201Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:28.999732Z", "completed_at": "2025-08-22T00:08:28.999739Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.016862154006958008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.int_malibu__applications", "compiled": true, "compiled_code": "with rebuild_points as (\n    select * from TRANSFORM_DDRC_PRD.malibu.stg_malibu__fire_rebuild_points\n)\n\nselect\n    type,\n    lat,\n    lon,\n    project_number,\n    planning_approved,\n    convert_timezone('UTC', last_updated) as last_updated\nfrom rebuild_points\nwhere _load_date = (select max(r._load_date) from rebuild_points as r)", "relation_name": "TRANSFORM_DDRC_PRD.malibu.int_malibu__applications", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:28.990652Z", "completed_at": "2025-08-22T00:08:28.997611Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.001124Z", "completed_at": "2025-08-22T00:08:29.001131Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.013038873672485352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.int_malibu__permits_issued", "compiled": true, "compiled_code": "with permits_issued as (\n    select * from TRANSFORM_DDRC_PRD.malibu.stg_malibu__palisades_permits_issued_read\n)\n\nselect\n    type,\n    permits,\n    convert_timezone('UTC', last_updated) as last_updated\nfrom permits_issued\nwhere _load_date = (select max(pi._load_date) from permits_issued as pi)", "relation_name": "TRANSFORM_DDRC_PRD.malibu.int_malibu__permits_issued", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.007244Z", "completed_at": "2025-08-22T00:08:29.024506Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.026628Z", "completed_at": "2025-08-22T00:08:29.026643Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.024266958236694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.int_pasadena__eaton_fire_rebuild_permits", "compiled": true, "compiled_code": "with rebuild_permits as (\n    select * from TRANSFORM_DDRC_PRD.pasadena.stg_pasadena__eaton_fire_rebuild_permits\n)\n\nselect\n    permit_number,\n    parcel_number,\n    address,\n    city,\n    state,\n    zipcode,\n    permit_status,\n    work_class,\n    permit_type,\n    description,\n    council_district,\n    convert_timezone('UTC', last_updated) as last_updated\nfrom rebuild_permits\nwhere _load_date = (select max(r._load_date) from rebuild_permits as r)", "relation_name": "TRANSFORM_DDRC_PRD.pasadena.int_pasadena__eaton_fire_rebuild_permits", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.014853Z", "completed_at": "2025-08-22T00:08:29.025553Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.028053Z", "completed_at": "2025-08-22T00:08:29.028061Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.023860692977905273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.int_epa__most_recent_public_status_assessment", "compiled": true, "compiled_code": "with psa as (\n\n    select * from TRANSFORM_DDRC_PRD.epa.stg_epa__public_status_assessment\n\n),\n\nmost_recent_psa_data as (\n\n    select\n        public_status,\n        land_use,\n        fire_name,\n        convert_timezone('UTC', last_updated) as last_updated\n    from psa\n    where load_date = (select max(p.load_date) from psa as p)\n)\n\nselect * from most_recent_psa_data", "relation_name": "TRANSFORM_DDRC_PRD.epa.int_epa__most_recent_public_status_assessment", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.010903Z", "completed_at": "2025-08-22T00:08:29.026052Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.028897Z", "completed_at": "2025-08-22T00:08:29.028906Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02581310272216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.int_usace__most_recent_debris_removal", "compiled": true, "compiled_code": "with pdr as (\n    select * from TRANSFORM_DDRC_PRD.usace.stg_usace__parcel_debris_removal\n),\n\nmost_recent_pdr_data as (\n\n    select\n        ma,\n        epa_status,\n        roe_status,\n        roe_approved,\n        roe_submitted,\n        roe_details,\n        hsa_status,\n        pcr_status,\n        fso_pkg_approved,\n        object_id,\n        event_sub_name,\n        _load_date,\n        convert_timezone('UTC', last_updated) as last_updated\n\n    from pdr\n    where last_updated = (select max(p.last_updated) from pdr as p)\n\n)\n\nselect * from most_recent_pdr_data", "relation_name": "TRANSFORM_DDRC_PRD.usace.int_usace__most_recent_debris_removal", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.021200Z", "completed_at": "2025-08-22T00:08:29.027548Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.030381Z", "completed_at": "2025-08-22T00:08:29.030390Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02018427848815918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.malibu_permitting_metrics", "compiled": true, "compiled_code": "with applications as (\n    select * from TRANSFORM_DDRC_PRD.malibu.int_malibu__applications\n),\n\nmalibu_rebuild_applications_received as (\n    select\n        'malibu_rebuild_applications_received' as metric_name,\n        count(*) as metric_value\n    from applications\n),\n\nmalibu_rebuild_applications_in_review as (\n    select\n        'malibu_rebuild_applications_in_review' as metric_name,\n        count(*) as metric_value\n    from applications\n    where type in ('InPlanning', 'InBPC')\n),\n\nmalibu_building_permits_issued as (\n    select\n        'malibu_building_permits_issued' as metric_name,\n        count(*) as metric_value\n    from applications\n    where type in ('PermitIssued')\n),\n\n-- TODO: what building permits are in the permits issued table?\n-- seems to be different from the pplications table.\n/*malibu_building_permits_issued as (\n    select\n        'malibu_building_permits_issued' as metric_name,\n        any_value(permits) as metric_value,\n        any_value(last_updated) as last_updated\n    from TRANSFORM_DDRC_PRD.malibu.int_malibu__permits_issued\n    where type = 'Building'\n),*/\n\ncombined as (\n    select * from malibu_rebuild_applications_received\n    union all\n    select * from malibu_rebuild_applications_in_review\n    union all\n    select * from malibu_building_permits_issued\n)\n\nselect\n    combined.*,\n    (select max(a.last_updated) as last_updated from applications as a) as last_updated\nfrom combined", "relation_name": "ANALYTICS_DDRC_PRD.permitting.malibu_permitting_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.017951Z", "completed_at": "2025-08-22T00:08:29.029641Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.031905Z", "completed_at": "2025-08-22T00:08:29.031915Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.025693178176879883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.airtable__most_recent_metrics", "compiled": true, "compiled_code": "with air as (\n\n    select * from TRANSFORM_DDRC_PRD.airtable.stg_airtable__metrics\n    where metric is not null\n\n),\n\n-- select most recent version of each individual metric\nmax_modified as (\n    select\n        metric_machine_name,\n        to_number(metric, 38, 2) as metric,\n        metric_type,\n        metric_unit_label,\n        lower(update_frequency) as update_frequency,\n        date_created,\n        max(date_created)\n            over (partition by metric_name) as last_updated\n    from air\n)\n\nselect\n    metric_machine_name,\n    metric,\n    metric_type,\n    metric_unit_label,\n    update_frequency,\n    date_created,\n    last_updated\nfrom max_modified\nwhere date_created = last_updated\ngroup by all", "relation_name": "ANALYTICS_DDRC_PRD.airtable.airtable__most_recent_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.042161Z", "completed_at": "2025-08-22T00:08:29.062374Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.076380Z", "completed_at": "2025-08-22T00:08:29.076399Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04270434379577637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.pasadena_permitting_metrics", "compiled": true, "compiled_code": "with pasadena_permitting as (\n    select * from TRANSFORM_DDRC_PRD.pasadena.int_pasadena__eaton_fire_rebuild_permits\n),\n\npasadena_rebuild_applications_received as (\n    select\n        'pasadena_rebuild_applications_received' as metric_name,\n        count(*) as metric_value\n    from pasadena_permitting\n),\n\npasadena_rebuild_applications_in_review as (\n    select\n        'pasadena_rebuild_applications_in_review' as metric_name,\n        count(*) as metric_value\n    from pasadena_permitting\n    where permit_status in ('In Review')\n),\n\npasadena_building_permits_issued as (\n    select\n        'pasadena_building_permits_issued' as metric_name,\n        count(*) as metric_value\n    from pasadena_permitting\n    where permit_status in ('Issued')\n),\n\ncombined as (\n    select * from pasadena_rebuild_applications_received\n    union all\n    select * from pasadena_rebuild_applications_in_review\n    union all\n    select * from pasadena_building_permits_issued\n)\n\nselect\n    combined.*,\n    (select max(p.last_updated) as last_updated from pasadena_permitting as p) as last_updated\nfrom combined", "relation_name": "ANALYTICS_DDRC_PRD.permitting.pasadena_permitting_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.045186Z", "completed_at": "2025-08-22T00:08:29.063064Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.077453Z", "completed_at": "2025-08-22T00:08:29.077464Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.04304361343383789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.usace__dashboard_metrics", "compiled": true, "compiled_code": "with usace as (\n\n    select * from TRANSFORM_DDRC_PRD.usace.int_usace__most_recent_debris_removal\n    where\n        event_sub_name in ('Eaton', 'Palisades')\n        and ma = '4856DR-CA-COE-SPD-09'\n\n),\n\nroe_status as (\n    select\n        'phase2_roes_accepted' as metric_name,\n        'TK' as metric_unit_label,\n        count(distinct object_id) as metric_value,\n        last_updated\n    from usace\n    where\n        roe_approved is not null\n        and roe_status not in ('returned_ineligible', 'returned_withdrawn')\n        and roe_details = 'County'\n    group by all\n),\n\nin_queue as (\n    select\n        'phase2_parcels_in_queue' as metric_name,\n        'TK' as metric_unit_label,\n        count(distinct object_id) as metric_value,\n        last_updated\n    from usace\n    where\n        roe_submitted is not null\n        and roe_status not in ('returned_ineligible', 'returned_withdrawn')\n        and roe_details = 'County'\n    group by all\n\n),\n\n-- reinstating this metric per Matt's request 3/20\nfso_return as (\n    select\n        'phase2_parcels_completed' as metric_name,\n        'TK' as metric_unit_label,\n        count(distinct object_id) as metric_value,\n        last_updated\n    from usace\n    where\n        fso_pkg_approved is not null\n        and roe_status not in ('returned_ineligible', 'returned_withdrawn')\n        and roe_details = 'County'\n    group by all\n),\n\nusace_dashboard_metrics as (\n\n    select * from roe_status\n    union all\n    select * from in_queue\n    union all\n    select * from fso_return\n\n)\n\nselect * from usace_dashboard_metrics", "relation_name": "ANALYTICS_DDRC_PRD.usace.usace__dashboard_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.049499Z", "completed_at": "2025-08-22T00:08:29.071362Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.080127Z", "completed_at": "2025-08-22T00:08:29.080135Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.04414105415344238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.public_status_by_land_use_and_fire_name_counted", "compiled": true, "compiled_code": "with most_recent_psa_data as (\n    select * from TRANSFORM_DDRC_PRD.epa.int_epa__most_recent_public_status_assessment\n),\n\nps_by_land_use_and_fire_name_counted as (\n\n    select\n        public_status,\n        COUNT(public_status) as public_status_count,\n        land_use,\n        fire_name,\n        last_updated\n\n    from most_recent_psa_data\n    group by public_status, land_use, fire_name, last_updated\n\n)\n\nselect * from ps_by_land_use_and_fire_name_counted", "relation_name": "ANALYTICS_DDRC_PRD.epa.public_status_by_land_use_and_fire_name_counted", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.057805Z", "completed_at": "2025-08-22T00:08:29.078283Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.082472Z", "completed_at": "2025-08-22T00:08:29.082481Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04292464256286621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.is_non_floating_point_airtable__most_recent_metrics_metric__count__metric_type.6082889d4c", "compiled": true, "compiled_code": "\n\nwith validation as (\n\n    select\n        metric_type as metric_type,\n        metric as non_floating_point_field\n\n    from ANALYTICS_DDRC_PRD.airtable.airtable__most_recent_metrics\n\n),\n\nvalidation_errors as (\n\n    select\n        non_floating_point_field\n\n    from validation\n    -- if this is true, then non_floating_point_field contains decimals\n\n    where MOD(non_floating_point_field,1) <> 0\n    and metric_type  = 'count'\n\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.053723Z", "completed_at": "2025-08-22T00:08:29.079017Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.084410Z", "completed_at": "2025-08-22T00:08:29.084418Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.04539227485656738, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.is_positive_or_zero_airtable__most_recent_metrics_metric__dollars_millions__metric_type.8485dff128", "compiled": true, "compiled_code": "\n\nwith validation as (\n\n    select\n        metric_type as metric_type,\n        metric as positive_field\n\n    from ANALYTICS_DDRC_PRD.airtable.airtable__most_recent_metrics\n\n),\n\nvalidation_errors as (\n\n    select\n        positive_field\n\n    from validation\n    -- if this is true, then positive_field is negative\n    where positive_field < 0 and metric_type  = 'dollars - millions'\n\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.063614Z", "completed_at": "2025-08-22T00:08:29.079634Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.085150Z", "completed_at": "2025-08-22T00:08:29.085158Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04459500312805176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.is_positive_or_zero_airtable__most_recent_metrics_metric__count__metric_type.0467721b07", "compiled": true, "compiled_code": "\n\nwith validation as (\n\n    select\n        metric_type as metric_type,\n        metric as positive_field\n\n    from ANALYTICS_DDRC_PRD.airtable.airtable__most_recent_metrics\n\n),\n\nvalidation_errors as (\n\n    select\n        positive_field\n\n    from validation\n    -- if this is true, then positive_field is negative\n    where positive_field < 0 and metric_type  = 'count'\n\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.067578Z", "completed_at": "2025-08-22T00:08:29.081084Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.086052Z", "completed_at": "2025-08-22T00:08:29.086059Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.044991493225097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.is_over_threshold_airtable__most_recent_metrics_metric__metric_machine_name__people_helped_fema_funds__100.349036ae73", "compiled": true, "compiled_code": "\n\nwith validation as (\n\n    select\n        metric_machine_name as metric_column_name,\n        metric as amount_field\n\n    from ANALYTICS_DDRC_PRD.airtable.airtable__most_recent_metrics\n\n),\n\nvalidation_errors as (\n\n    select\n        amount_field\n\n    from validation\n    -- if this is true, amount is not over threshold.\n    where amount_field < 100 and metric_column_name  = 'people_helped_fema_funds'\n\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.071978Z", "completed_at": "2025-08-22T00:08:29.081778Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.087362Z", "completed_at": "2025-08-22T00:08:29.087370Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.04577445983886719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.is_over_threshold_airtable__most_recent_metrics_metric__metric_machine_name__people_helped_drc__50000.ee0cfbf8e1", "compiled": true, "compiled_code": "\n\nwith validation as (\n\n    select\n        metric_machine_name as metric_column_name,\n        metric as amount_field\n\n    from ANALYTICS_DDRC_PRD.airtable.airtable__most_recent_metrics\n\n),\n\nvalidation_errors as (\n\n    select\n        amount_field\n\n    from validation\n    -- if this is true, amount is not over threshold.\n    where amount_field < 50000 and metric_column_name  = 'people_helped_drc'\n\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.099904Z", "completed_at": "2025-08-22T00:08:29.104673Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.105178Z", "completed_at": "2025-08-22T00:08:29.105194Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.01577162742614746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caldata_ddrc_pipelines.ddrc_metrics_summary", "compiled": true, "compiled_code": "with epa_count_phase1_complete as (\n    select\n        'cleanup_phase1_complete' as metric_name,\n        sum(public_status_count) as metric_value,\n        'count' as metric_type,\n        'cleanups completed' as metric_unit_label,\n        'daily' as update_frequency, --acceptable values for this field are 'As needed', 'Daily', 'Weekly', or 'Monthly'\n        max(last_updated) as last_updated\n    from ANALYTICS_DDRC_PRD.epa.public_status_by_land_use_and_fire_name_counted\n    where\n        public_status in ('Phase 1 Complete', 'Deferred to Phase 2')\n        and land_use = 'Residential'\n),\n\nusace_parcel_debris_metrics as (\n    select\n        metric_name,\n        metric_value,\n        'count' as metric_type,\n        metric_unit_label,\n        'daily' as update_frequency,\n        last_updated\n    from ANALYTICS_DDRC_PRD.usace.usace__dashboard_metrics\n),\n\nmalibu_permitting_metrics as (\n    select\n        metric_name,\n        metric_value,\n        'count' as metric_type,\n        'TK' as metric_unit_label,\n        'daily' as update_frequency,\n        last_updated\n    from ANALYTICS_DDRC_PRD.permitting.malibu_permitting_metrics\n),\n\npasadena_permitting_metrics as (\n    select\n        metric_name,\n        metric_value,\n        'count' as metric_type,\n        'TK' as metric_unit_label,\n        'daily' as update_frequency,\n        last_updated\n    from ANALYTICS_DDRC_PRD.permitting.pasadena_permitting_metrics\n),\n\n--As additional automated metrics (as in, metrics that are not\n--manually entered into the airtable are added to the DDRC,\n--union them together here:\npipeline_metrics as (\n    select * from epa_count_phase1_complete\n    union all\n    select * from usace_parcel_debris_metrics\n    union all\n    select * from malibu_permitting_metrics\n    union all\n    select * from pasadena_permitting_metrics\n),\n\n--The Airtable captures all metrics, including those\n--entered manually, we will use it to add in any of the metrics\n--that we do not have automated pipelines for yet:\nairtable_metrics as (\n    select\n        metric_machine_name as metric_name,\n        metric as metric_value,\n        metric_type,\n        metric_unit_label,\n        update_frequency,\n        last_updated\n    from ANALYTICS_DDRC_PRD.airtable.airtable__most_recent_metrics\n    where\n        metric_name not in (select pm.metric_name from pipeline_metrics as pm) -- this line ensures we are always\n        --prioritizing a metric coming from one of our API pipelines, if it also exists in airtable\n),\n\n-- Note: deliberately not casting last_updated timestamp_tz in this model.\n-- It's enforced by the contract, and if anything *not* a UTC timestamp sneaks in,\n-- the union should fail\nddrc_metrics as (\n    select * from pipeline_metrics\n    union all\n    select * from airtable_metrics\n)\n\nselect\n    metric_name,\n    to_number(metric_value, 38, 2) as metric_value,\n    metric_type,\n    metric_unit_label,\n    update_frequency,\n    last_updated\nfrom ddrc_metrics", "relation_name": "ANALYTICS_DDRC_PRD.summary.ddrc_metrics_summary", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.091628Z", "completed_at": "2025-08-22T00:08:29.106400Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.107425Z", "completed_at": "2025-08-22T00:08:29.107433Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.01935291290283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.is_positive_or_zero_usace__dashboard_metrics_metric_value__TK__metric_unit_label.ff2027b207", "compiled": true, "compiled_code": "\n\nwith validation as (\n\n    select\n        metric_unit_label as metric_type,\n        metric_value as positive_field\n\n    from ANALYTICS_DDRC_PRD.usace.usace__dashboard_metrics\n\n),\n\nvalidation_errors as (\n\n    select\n        positive_field\n\n    from validation\n    -- if this is true, then positive_field is negative\n    where positive_field < 0 and metric_type  = 'TK'\n\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.095958Z", "completed_at": "2025-08-22T00:08:29.106933Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.111161Z", "completed_at": "2025-08-22T00:08:29.111173Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022534847259521484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.is_non_floating_point_usace__dashboard_metrics_metric_value__TK__metric_unit_label.899462e975", "compiled": true, "compiled_code": "\n\nwith validation as (\n\n    select\n        metric_unit_label as metric_type,\n        metric_value as non_floating_point_field\n\n    from ANALYTICS_DDRC_PRD.usace.usace__dashboard_metrics\n\n),\n\nvalidation_errors as (\n\n    select\n        non_floating_point_field\n\n    from validation\n    -- if this is true, then non_floating_point_field contains decimals\n\n    where MOD(non_floating_point_field,1) <> 0\n    and metric_type  = 'TK'\n\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.130063Z", "completed_at": "2025-08-22T00:08:29.156681Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.163945Z", "completed_at": "2025-08-22T00:08:29.163958Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05084872245788574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.accepted_values_ddrc_metrics_summary_update_frequency__as_needed__daily__weekly__monthly__completed__content_update.ac2927b454", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        update_frequency as value_field,\n        count(*) as n_records\n\n    from ANALYTICS_DDRC_PRD.summary.ddrc_metrics_summary\n    group by update_frequency\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'as needed','daily','weekly','monthly','completed','content update'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.143654Z", "completed_at": "2025-08-22T00:08:29.157317Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.164826Z", "completed_at": "2025-08-22T00:08:29.164833Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05018305778503418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.is_positive_or_zero_ddrc_metrics_summary_metric_value__dollars_millions__metric_type.0bafc03e06", "compiled": true, "compiled_code": "\n\nwith validation as (\n\n    select\n        metric_type as metric_type,\n        metric_value as positive_field\n\n    from ANALYTICS_DDRC_PRD.summary.ddrc_metrics_summary\n\n),\n\nvalidation_errors as (\n\n    select\n        positive_field\n\n    from validation\n    -- if this is true, then positive_field is negative\n    where positive_field < 0 and metric_type  = 'dollars - millions'\n\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.120799Z", "completed_at": "2025-08-22T00:08:29.157908Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.165653Z", "completed_at": "2025-08-22T00:08:29.165663Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.05312061309814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.not_null_ddrc_metrics_summary_last_updated.d5bb7e8fc2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_updated\nfrom ANALYTICS_DDRC_PRD.summary.ddrc_metrics_summary\nwhere last_updated is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.134933Z", "completed_at": "2025-08-22T00:08:29.158411Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.166894Z", "completed_at": "2025-08-22T00:08:29.166903Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.05324530601501465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.is_non_floating_point_ddrc_metrics_summary_metric_value__count__metric_type.72529e5d65", "compiled": true, "compiled_code": "\n\nwith validation as (\n\n    select\n        metric_type as metric_type,\n        metric_value as non_floating_point_field\n\n    from ANALYTICS_DDRC_PRD.summary.ddrc_metrics_summary\n\n),\n\nvalidation_errors as (\n\n    select\n        non_floating_point_field\n\n    from validation\n    -- if this is true, then non_floating_point_field contains decimals\n\n    where MOD(non_floating_point_field,1) <> 0\n    and metric_type  = 'count'\n\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.139103Z", "completed_at": "2025-08-22T00:08:29.159006Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.167655Z", "completed_at": "2025-08-22T00:08:29.167662Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.053511619567871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.is_positive_or_zero_ddrc_metrics_summary_metric_value__count__metric_type.6ea1fe4f1b", "compiled": true, "compiled_code": "\n\nwith validation as (\n\n    select\n        metric_type as metric_type,\n        metric_value as positive_field\n\n    from ANALYTICS_DDRC_PRD.summary.ddrc_metrics_summary\n\n),\n\nvalidation_errors as (\n\n    select\n        positive_field\n\n    from validation\n    -- if this is true, then positive_field is negative\n    where positive_field < 0 and metric_type  = 'count'\n\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.147454Z", "completed_at": "2025-08-22T00:08:29.163447Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.168524Z", "completed_at": "2025-08-22T00:08:29.168532Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.05336284637451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.not_null_ddrc_metrics_summary_metric_name.b4ffdc1ee1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect metric_name\nfrom ANALYTICS_DDRC_PRD.summary.ddrc_metrics_summary\nwhere metric_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.151724Z", "completed_at": "2025-08-22T00:08:29.166412Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.171551Z", "completed_at": "2025-08-22T00:08:29.171559Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.05530500411987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.not_null_ddrc_metrics_summary_metric_type.2672c68e39", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect metric_type\nfrom ANALYTICS_DDRC_PRD.summary.ddrc_metrics_summary\nwhere metric_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.159545Z", "completed_at": "2025-08-22T00:08:29.169869Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.173116Z", "completed_at": "2025-08-22T00:08:29.173123Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05344724655151367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.not_null_ddrc_metrics_summary_metric_unit_label.443107838c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect metric_unit_label\nfrom ANALYTICS_DDRC_PRD.summary.ddrc_metrics_summary\nwhere metric_unit_label is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.176553Z", "completed_at": "2025-08-22T00:08:29.191883Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.192425Z", "completed_at": "2025-08-22T00:08:29.192439Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019964933395385742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.not_null_ddrc_metrics_summary_metric_value.425b3e7451", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect metric_value\nfrom ANALYTICS_DDRC_PRD.summary.ddrc_metrics_summary\nwhere metric_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.180649Z", "completed_at": "2025-08-22T00:08:29.193378Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.193883Z", "completed_at": "2025-08-22T00:08:29.193890Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020110130310058594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.not_null_ddrc_metrics_summary_update_frequency.4efc6b8993", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect update_frequency\nfrom ANALYTICS_DDRC_PRD.summary.ddrc_metrics_summary\nwhere update_frequency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T00:08:29.185185Z", "completed_at": "2025-08-22T00:08:29.194669Z"}, {"name": "execute", "started_at": "2025-08-22T00:08:29.195305Z", "completed_at": "2025-08-22T00:08:29.195313Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.021004438400268555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caldata_ddrc_pipelines.unique_ddrc_metrics_summary_metric_name.45e011303d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    metric_name as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS_DDRC_PRD.summary.ddrc_metrics_summary\nwhere metric_name is not null\ngroup by metric_name\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 9.097131967544556, "args": {"strict_mode": false, "quiet": false, "target": "prd", "validate_macro_args": false, "populate_cache": true, "compile": true, "use_colors": true, "log_file_max_bytes": 10485760, "require_yaml_configuration_for_mf_time_spines": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "invocation_command": "dbt docs generate --project-dir=transform --target=prd", "log_level": "info", "favor_state": false, "cache_selected_only": false, "partial_parse_file_diff": true, "which": "generate", "macro_debugging": false, "show_resource_report": false, "empty_catalog": false, "project_dir": "transform", "select": [], "defer": false, "partial_parse": true, "require_all_warnings_handled_by_warn_error": false, "static": false, "require_nested_cumulative_type_params": false, "require_explicit_package_overrides_for_builtin_materializations": true, "require_batched_execution_for_custom_microbatch_strategy": false, "log_path": "transform/logs", "source_freshness_run_project_hooks": true, "use_fast_test_edges": false, "vars": {}, "log_format_file": "debug", "require_resource_names_without_spaces": true, "indirect_selection": "eager", "profiles_dir": "transform/ci", "show_all_deprecations": false, "static_parser": true, "introspect": true, "exclude": [], "state_modified_compare_more_unrendered_values": false, "send_anonymous_usage_stats": false, "state_modified_compare_vars": false, "require_generic_test_arguments_property": false, "version_check": true, "upload_to_artifacts_ingest_api": false, "write_json": true, "use_colors_file": true, "skip_nodes_if_on_run_start_fails": false, "log_level_file": "debug", "log_format": "default", "print": true, "printer_width": 80}}